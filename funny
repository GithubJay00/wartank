print("loaded")

local MT = getrawmetatable(game)

local OldIndex = MT. __index
local OldNamecall = MT.__namecall

setreadonly(MT, false)

MT.__index = newcclosure(function(P, M, TH, TI, HB, SZ)
	if not checkcaller() and getnamecallmethod() then
		if tostring(P) == "Position" and tostring(M) == "Magnitude" then return end
		if tostring(HB) == "HumanoidRootPart" and tostring(SZ) == "Size" then return end
		if tostring(TH) == "Handle" then return end
		if tostring(TI) == "firetouchinterest" then return end
	end
	return OldIndex(P, M, TH, TI, HB, SZ)
end)

for _, v in next, getconnections(game:GetService("LogService").MessageOut) do v:Disable() end
for _, v in next, getconnections(game:GetService("ScriptContext").Error) do v:Disable() end
game:GetService("ScriptContext"):SetTimeout(0.1)

setreadonly(MT, true)

local RunService = game:GetService("RunService")
local Players = game:GetService("Players")
local player = Players.LocalPlayer

while RunService.Stepped:Wait() do
	for _, Player in pairs(Players:GetPlayers()) do
		if Player.Name == player.Name then continue end
		
		local Character = Player.Character
		local RootPart = Character and Character:FindFirstChild("HumanoidRootPart")
		local Humanoid = Character and Character:FindFirstChild("Humanoid")
		
		if not Character or not RootPart or not Humanoid then 
			continue 
		end
		
		task.spawn(function()
			RunService.Stepped:Wait()
			
			local RightArm = Character and Character:FindFirstChild("Right Arm")
			local RightGrip = RightArm and RightArm:FindFirstChild("RightGrip")
			
			local Health = Humanoid and Humanoid.Health
			local Tool =  Character and Character:FindFirstChildOfClass("Tool")
			
			if (RightArm.Position - rootpart.Position).Magnitude < 7 and Tool and Health < 101 then
				
				Tool.Parent = Player.Backpack
				RightGrip.Parent = nil

				RunService.RenderStepped:Wait()

				if Tool.Parent then
					Tool.Parent = Character
					RightGrip.Parent = RightArm 
				end
			end
		end)
	end
end
